<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Boomerang: ProcCFG.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="boomerang_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Boomerang
   &#160;<span id="projectnumber">v0.5.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ProcCFG_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ProcCFG.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ExpHelp_8h_source.html">boomerang/ssl/exp/ExpHelp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Address_8h_source.html">boomerang/util/Address.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="MapIterators_8h_source.html">boomerang/util/MapIterators.h</a>&quot;</code><br />
<code>#include &lt;list&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ProcCFG.h:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ProcCFG_8h__incl.svg" width="100%" height="563"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ProcCFG_8h__dep__incl.svg" width="100%" height="496"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="ProcCFG_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae4f36a021372714a2b56f8d77b4bdda4"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcCFG_8h.html#ae4f36a021372714a2b56f8d77b4bdda4">RTLList</a> = std::list&lt; std::unique_ptr&lt; RTL &gt; &gt;</td></tr>
<tr class="separator:ae4f36a021372714a2b56f8d77b4bdda4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ace890ccede2b1afcffd5583512f1cc62"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ProcCFG_8h.html#ace890ccede2b1afcffd5583512f1cc62">__attribute__</a> ((visibility(&quot;default&quot;))) ProcCFG</td></tr>
<tr class="memdesc:ace890ccede2b1afcffd5583512f1cc62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains all the BasicBlock objects for a single UserProc.  <a href="ProcCFG_8h.html#ace890ccede2b1afcffd5583512f1cc62">More...</a><br /></td></tr>
<tr class="separator:ace890ccede2b1afcffd5583512f1cc62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ae4f36a021372714a2b56f8d77b4bdda4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4f36a021372714a2b56f8d77b4bdda4">&#9670;&nbsp;</a></span>RTLList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="BasicBlock_8h.html#ae4f36a021372714a2b56f8d77b4bdda4">RTLList</a> =  std::list&lt;std::unique_ptr&lt;RTL&gt; &gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ProcCFG_8h_source.html#l00029">29</a> of file <a class="el" href="ProcCFG_8h_source.html">ProcCFG.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ace890ccede2b1afcffd5583512f1cc62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace890ccede2b1afcffd5583512f1cc62">&#9670;&nbsp;</a></span>__attribute__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class __attribute__ </td>
          <td>(</td>
          <td class="paramtype">(visibility(&quot;default&quot;))&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Contains all the BasicBlock objects for a single UserProc. </p>
<p>These BBs contain all the RTLs for the procedure, so by traversing the ProcCFG, one traverses the whole procedure. </p>
<p>Creates an empty CFG for the function <code>proc</code> </p>
<p>Note: When removing a BB, the iterator(s) pointing to the removed BB are invalidated.</p>
<p>Remove all basic blocks from the CFG</p>
<dl class="section return"><dt>Returns</dt><dd>the number of (complete and incomplete) BBs in this CFG.</dd></dl>
<p>Checks if the BB is part of this CFG</p>
<p>Create a new Basic Block for this CFG. If the BB is blocked by a larger complete BB, the existing BB will be split at the first address of <code>bbRTLs</code>; in this case this function returns nullptr (since no BB was created). The case of the new BB being blocked by a smaller complete BB is not handled by this method; use ProcCFG::ensureBBExists instead.</p>
<p>The new BB might also be blocked by exising incomplete BBs. If this is the case, the new BB will be split at all blocking incomplete BBs, and fallthrough edges will be added between parts of the split BB. In this case, the incomplete BBs will be removed (since we just completed them).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bbType</td><td>Type of the new Basic Block </td></tr>
    <tr><td class="paramname">bbRTLs</td><td>RTL list with semantics of all instructions contained in this BB. Must not be empty.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the newly created BB, or the exisitng BB if the new BB is the same as another exising complete BB.</dd></dl>
<p>Creates a new incomplete BB at address <code>startAddr</code>. Creating an incomplete BB will cause the ProcCFG to not be well-fomed until all incomplete BBs are completed by calling createBB.</p>
<p>Ensures that <code>addr</code> is the start of a complete or incomplete BasicBlock.</p>
<p>Explicit labels are addresses that have already been tagged as being labels due to transfers of control to that address (i.e. they are the start of a complete Basic Block). Non explicit labels are addresses that are in the middle of a complete Basic Block. In this case, the existing complete BB is split. If <code>currBB</code> is the BB that gets split, <code>currBB</code> is updated to point to the "high" part of the split BB (address wise).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>native (source) address to check </td></tr>
    <tr><td class="paramname">currBB</td><td>See above </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the BB starting at <code>address</code> is (now) complete, false otherwise.</dd></dl>
<p>Get a (complete or incomplete) BasicBlock starting at the given address. If there is no such block, return nullptr.</p>
<p>Check if <code>addr</code> is the start of a basic block, complete or not</p>
<p>Check if the given address is the start of an incomplete basic block.</p>
<dl class="section return"><dt>Returns</dt><dd>the entry BB of the procedure of this CFG</dd></dl>
<p>Set the entry bb to <code>entryBB</code> and mark all return BBs as exit BBs.</p>
<p>Completely removes a single BB from this CFG. </p><dl class="section note"><dt>Note</dt><dd><code>bb</code> is invalid after this function returns.</dd></dl>
<p>Add an edge from <code>sourceBB</code> to <code>destBB</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sourceBB</td><td>the start of the edge. </td></tr>
    <tr><td class="paramname">destBB</td><td>the destination of the edge.</td></tr>
  </table>
  </dd>
</dl>
<p>Add an out edge from <code>sourceBB</code> to address <code>destAddr</code>. If <code>destAddr</code> is the start of a complete BB, add an edge from <code>sourceBB</code> to the complete BB. If <code>destAddr</code> is in the middle of a complete BB, the BB will be split; the edge will be added to the "high" part of the split BB. Otherwise, an incomplete BB will be created and the edge will be added to it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sourceBB</td><td>the source of the edge </td></tr>
    <tr><td class="paramname">destAddr</td><td>the destination of a CTI (jump or call)</td></tr>
  </table>
  </dd>
</dl>
<p>Checks that all BBs are complete, and all out edges are valid. Also checks that the ProcCFG does not contain interprocedural edges. By definition, the empty CFG is well-formed.</p>
<p>Simplify all the expressions in the CFG</p>
<p>Find the existing implicit assign for x (if any)</p>
<p>Find exiting implicit assign for parameter p</p>
<p>Remove an existing implicit assignment for x</p>
<p>Find or create an implicit assign for x</p>
<p>Split <code>bb</code> into a "low" and "high" part at the RTL associated with <code>splitAddr</code>. The type of the "low" BB becomes fall-through. The type of the "high" part becomes the type of <code>bb</code>.</p>
<p>\ | / \ | / +&mdash;+ bb +&mdash;+ BB1 | | +&mdash;+ | | ==&gt; | Fallthrough +&mdash;+ +&mdash;+ / | \ +&mdash;+ BB2 / | \</p>
<p>If <code>splitAddr</code> is not in the range [bb-&gt;getLowAddr, bb-&gt;getHiAddr], the split fails. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bb</td><td>pointer to the BB to be split </td></tr>
    <tr><td class="paramname">splitAddr</td><td>address of RTL to become the start of the new BB </td></tr>
    <tr><td class="paramname">newBB</td><td>if non zero, it remains as the "bottom" part of the BB, and splitBB only modifies the top part to not overlap. If this is the case, the RTLs of the original BB are deleted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the merge is successful, returns the "high" part of the split BB. Otherwise, returns the original BB.</dd></dl>
<p>print this CFG, mainly for debugging</p>
<p>&lt; Procedure to which this CFG belongs.</p>
<p>&lt; The Address to BB map</p>
<p>&lt; The CFG entry BasicBlock.</p>
<p>&lt; The CFG exit BasicBlock.</p>
<p>Map from expression to implicit assignment. The purpose is to prevent multiple implicit assignments for the same location.</p>
<p>True when the implicits are done; they can cause problems (e.g. with ad-hoc global assignment)</p>

<p class="definition">Definition at line <a class="el" href="ProcCFG_8h_source.html#l00039">39</a> of file <a class="el" href="ProcCFG_8h_source.html">ProcCFG.h</a>.</p>

<p class="reference">References <a class="el" href="Address_8h_source.html#l00202">addr</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_8622b0e63b7fb230ba833b193101c161.html">boomerang</a></li><li class="navelem"><a class="el" href="dir_cacbc0f8d661c3f2ef6995c140cb013b.html">db</a></li><li class="navelem"><a class="el" href="dir_636445051267db0da9873ee5fca752ef.html">proc</a></li><li class="navelem"><a class="el" href="ProcCFG_8h.html">ProcCFG.h</a></li>
    <li class="footer">Generated on Fri Jan 15 2021 11:11:58 for Boomerang by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
